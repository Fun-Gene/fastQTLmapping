# xQTLmapping
 fast xQTL mapping tools



##   命令行参数

| 1    | omics1FileName | 基因组数据文件名，不包括扩展名，字符串 |
| ---- | -------------- | -------------------------------------- |
| 2    | omics2FileName | trait数据文件名，包括扩展名，字符串    |
| 3    | outputFileName | 输出文件文件名，字符串                 |
| 4    | NASign         | 缺失值标记，字符串                     |
| 5    | missingRateThd | missing rate 阈值，浮点型              |
| 6    | MAFThd         | MAF 阈值，浮点型                       |
| 7    | pFilter1Level  | 严格显著性阈值，浮点型                 |
| 8    | pFilter2Level  | 宽松显著性阈值，浮点型                 |
| 9    | thread_cout    | 并行数                                 |

 

##   输入

软件接收的命令行参数包括：基因组文件路径、甲基化组文件路径、缺失值标志、输出文件路径、并行数、严格的显著性阈值和宽松的显著性阈值。基因组数据的格式为plink软件生成的二进制基因组文件，一批数据由一组三个文件共同构成，它们的扩展名分别为*.bed,*.bim,*.fam。甲基化组文件为文本型，格式为无行名和列名的二维实数矩阵，每行表示一个样本，每列表示一个CpG位点，矩阵元素之间以空格作为分隔符。基因组数据的缺失值遵循plink格式的默认定义，甲基化组文件的缺失值可以是任意一个字符串标识，该标识需通过第四个命令行参数指明。严格的显著性阈值和宽松的显著性阈值都是(0,1]之间的浮点数，可以用科学计数法表示。

程序会从硬盘中读取基因组数据和甲基化组数据，并将它们分别保存到二维vector omics1Data和omics2Data中，每行表示一个SNP或CpG位点，每列表示一个样本。在此过程中，对样本、基因组中的SNP位点和甲基化组中的CpG位点数量进行计数，并将这些信息写入日志文件供用户核实。另外为基因组数据和甲基化组数据各维护一个二维vector，用以记录缺失值的编号。



##   输出

对于每一对SNP-CpG的回归结果，都使用命令行读入的宽松显著性阈值进行筛选。如果未达宽松阈值，则不予输出。对于达到了宽松阈值，但没有达到严格阈值的结果，输出回归结果中的β, t, -lg(P-value)。对于达到了严格阈值的结果，输出回归结果中的β, se,r2,t, -lg(P-value)。该步骤处于OpenMP的临界区内，所以并行化不会对结果输出的格式造成影响。之所以将结果直接写入硬盘，而非暂时保存在内存里，主要是为了降低峰值内存占用率；对硬盘的写入操作会拖慢线程的运行速度，但降低的效率可以接受。

如果程序正常运行，则会生成三个输出文件。设用户在命令行指定的输出文件路径为”output”，则文件”output.log”为日志文件，文件”output.strict”为严格阈值结果文件，文件”output.loose”为宽松阈值结果文件。



## 运行环境

  硬件环境：处理器24核或以上；内存(RAM)：128 GB或以上；硬盘256GB或以上。

  软件环境：基于x64处理器，64位操作系统，Linux v3.10.0及以上。

编程语言：C++。

库：MKL 2019.0或以上 ,GSL v2.6或以上，OpenMP。
